{
    "mapId": "town_square",
    "tileKey": {
      ".": "floor",
      "#": "wall",
      "W": "water",
      "T": "tree",
      " ": "empty"
    },
    "collision": ["#", "W", "T"],
    "tiles": [
      "############",
      "#....T.....#",
      "#..........#",
      "#...###....#",
      "#..........#",
      "#...T..W...#",
      "############"
    ],
    "npcs": [
      {
        "id": "door_switch_1",
        "position": [5, 2],
        "sprite": "switch_off",
        "dialog": {
          "default": [
            { "text": "It's a switch. Press it?" },
            { 
              "choices": [
                {
                  "text": "Yes",
                  "setFlag": "door1_unlocked",
                  "setSprite": "switch_on",
                  "next": "You pressed the switch! The door opened."
                },
                {
                  "text": "No",
                  "next": "You left the switch alone."
                }
              ]
            }
          ]
        }
      }
    ],
    "tileTriggers": {
      "4,4": {
        "onEnter": "startBattle",
        "args": { "enemyId": "rival_1" },
        "oneTime": true,
        "requiresFlag": "has_first_card"
      },
      "6,4": {
        "onEnter": "healCards",
        "onExit": "playHealSound",
        "repeatable": true
      },
      "7,2": {
        "onEnter": "setFlag",
        "args": { "flag": "entered_zone_1" },
        "oneTime": true
      }
    },
    "dynamicTiles": {
      "5,3": {
        "defaultTile": "#",
        "whenFlagActive": {
          "flag": "door1_unlocked",
          "tile": "."
        }
      }
    },
    "flags": {
      "door1_unlocked": false,
      "entered_zone_1": false
    }
  }